# 📚 스터디 템플릿

## 📖 1. 목차를 읽기 전에 든 생각

- 

## 📝 2. 내용 정리

인메모리 샤딩 

```java
String accountId = "A";
int partitionNumber = 7;
int partition = accountId.hashCode() % partitionNumber;
```

분산 트랜잭션 - 일관성을 유지하는 방법

- 2단계 커밋 (DB에 의존 하는 방식)
  - 저수준 방안 
  - 준비 단계를 실행하기 위해 데이터베이스 트랜잭션 실해 방식을 변경해야함
  - 모든 작업을 기다려야 하기 때문에 성능이 좋지 않음
  - 단일 장애 지점이 될 가능성이 높음
- TC/C
  - 고수준 방안
  - 보상 기반 분산 트랜잭션
  - 애플리케이션 계층에서 세부 사항을 관리하고 분산 트랜잭션의 복잡성을 처리해야 함

- Saga
  - 모든 연산은 순서대로 정렬되며, 각 연산은 독립 트랜잭션으로 실행
  - 연산은 처음부터 마지막까지 순서대로 실행
  - 연산이 실패하면 실패한 연산부터 역으로 처음까지 롤백됨
  - 연산 실행 순서 조율 방법
    - 분산 조율 
      - msa에서 사가 분산 트랜잭션 관련된 모든 서비스가 다른 서비스의 이벤트를 구독해 작업 수행
    - 중앙집중형 조율
      - 하나의 조정자가 모든 서비스가 올바른 순서로 작업을 실행하도록 조율

신뢰성 있는 이벤트 소싱 

- 합의 기반 복제 (래프트 알고리즘)
  -  절반 이상의 노드가 온라인 상태면 그 모두에 같은 데이터를 가짐
  - 노드의 역할
    - 리더 (최대 하나의 노드)
    - 후보
    - 팔로어 (나머지)

## 💡 3. 전부 읽고 난 후기

- 신뢰성 및 성능을 챙기기 위해서 다양한 장애지점을 고려해 설계를 해야함을 다시 한번 깨닫게 되는 계기였다.

## ❓ 4. 특별히 궁금했던 부분

- 인메모리 샤딩 
  - 만약에 파티션의 개수가 변경되는 경우 어떻게 재분배를 할 것인가?
- mmap 혹은 로컬 디스크에 저장하는 방식이 왜 유리한 것인지? 