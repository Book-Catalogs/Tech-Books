# 📚 스터디 템플릿

## 📖 1. 목차를 읽기 전에 든 생각

- 

## 📝 2. 내용 정리

지연 시간을 줄이는 방법

1. 중요 경로에서 실행할 작업 수를 줄인다.
   - 중요 매매 경로에서는 꼭 필요한 구성 요소만 두는 방식
2. 각 작업의 소요 시간을 줄인다.
   - 네트워크 및 디스크 사용량 경감
   - 각 작업의 실행 시간 경감
   - 네트워크 및 디스크 액세스 지연 시간을 모두 고려시 end-to-end 지연시간은 수십 ms에 달함
   - 해당 요소의 경우 모든 것을 동일한 서버에 배치해 네트워크를 통하는 구간을 없앰으로써 향상을 꾀할 수 있다.
   - 같은 서버 내 컴포넌트간 통신은 mmap을 통해 통신을 하는 방식

애플리케이션 루프 

- 실행 메커니즘 : while 순환문을 통해 실행할 작업을 계속 polling
- CPU 효율성을 극대화하기 위해 단일 스레드에서 실행 
- 애플리케이션 루프를 CPU 고정시 다음 장단점이 존재
  - 장점
    - Context Switch가 없다
    - 상태를 업데이트 하는 스레드가 단 하나 => 락을 사용할 필요가 없고, lock 경합도 없음
  - 단점
    - 각 작업이 애플리케이션 루프에서 오랜 시간 스레드를 점유하지 않도록 걸리는 시간을 신중하게 분석해야함

이벤트 소싱

- 현재 상태를 저장하는대신 상태를 변경하느 모든 이벤트의 immutable한 로그를 유지함
- 모든 이벤트를 순서대로 재생하면 상태를 복구 할 수 있어야 함

고가용성

고려 사항 

- 거래소 아키텍처의 단일 장애 지점을 식별해야 함 
- 장애 감지 및 백업 인스턴스로의 장애 조치 결정이 빨라야 함 

상태를 저장하는 컴포넌트는 사본간 상세 데이터를 복사할 수 있어야 함 

주 / 부 체결 엔진

- 주 체결 엔진 : 이벤트를 수신하고 처리
- 부 체결 엔진 : 이벤트를 수신 but 처리 X

결정론

- 기능적 결정론
  - 이벤트가 발생하는 실제 시간은 대체로 중요하지 않고, 순서가 가장 중요한 것이다.
- 지연시간 결정론
  - 각 거래의 처리 시간이 거의 같다

시장 데이터의 공정한 배포

- 안정적 UDP를 사용하는 멀티캐스트 

## 💡 3. 전부 읽고 난 후기

- 최근에 주변에서 msa를 외쳐서, msa만이 답인가에 대한 고민을 하고 있었는데, 해당 장에서 다시 한번 모든 것에 정답이 없음을 깨달았다.

## ❓ 4. 특별히 궁금했던 부분

- FIX를 SBE로 변환?
- Nack-Oriented Reliable Multicast

  - 주요 특징 

    - NACK 기반 손실 복구
      - 전통적인 TCP처럼 송신자가 매 전송마다 ACK(확인 응답)를 받는 방식이 아니라, 데이터가 손실되었을 때만 수신자가 NACK을 보내는 방식
      - 이를 통해 네트워크 부하를 줄이고 효율적으로 손실 복구가 가능함

    - 효율적인 멀티캐스트 지원
      - 멀티캐스트 환경에서 다수의 수신자가 존재하므로, 모든 수신자로부터 개별적인 ACK을 받는 것은 비효율적
      - NORM은 NACK을 활용하여 필요한 경우에만 손실 복구를 요청하므로 네트워크 트래픽을 최적화할 수 있음
    - FEC(Forward Error Correction) 지원
      - NORM은 손실 복구를 더 빠르고 안정적으로 수행하기 위해 FEC를 활용할 수 있음
      - FEC를 사용하면 일부 데이터 손실이 발생해도 추가적인 재전송 없이 원본 데이터를 복구할 수 있어 성능이 향상됨
    - 유연한 전송 방식
      - NORM은 대규모 데이터 배포, 실시간 스트리밍, 군사/재난통신 등 다양한 응용 분야에서 사용됨
      - TCP와 같은 점대점 프로토콜보다 멀티캐스트 환경에서 효율적이며, UDP보다 신뢰성을 높임

  - 장점

    - 멀티캐스트 네트워크에서 신뢰성을 보장하면서도 트래픽 부담을 줄일 수 있음
    - 필요할 때만 재전송 요청을 보내므로 불필요한 ACK 트래픽 감소
    - FEC 적용 시 손실 복구 속도 향상

  - 단점

    - 실시간 통신(TCP보다 느릴 수 있음)에서는 지연이 발생할 가능성이 있음
    - 네트워크 환경에 따라 NACK이 집중되면 성능 저하 가능성 있음