# 📚 스터디 템플릿

## 📖 1. 목차를 읽기 전에 든 생각

- 근접성 서비스.. 뭔가 위치 기반 관련 내용?

## 📝 2. 내용 정리

#### QPS (Query Per Second)

> 초당 처리되는 요청의 수를 나타냄
> 주로 서버, DB 등의 성능을 측정하거나 부하를 계산하는데 사용 됨

$$
QPS = \frac{\text{Query} \times \text{DAU}}{864,000}
$$

#### 주변 검색 알고리즘

- 2차원 검색
- 균등격자
- 지오해시(Geohash)

##### 2차원 검색

> 단순하게 주어진 반경으로  검색하는 방식

```sql
SELECT business_id, latitude, longithude
FROM business
WHERE (latitude BETWEEN :{:my_lat} - radius AND :{:my_lat} + radius)
AND (longitude BETWEEN :{my_long} - radius AND {my_long} + radius)
```

##### 균등 격자

작은 격자 또는 구획으로 나누는 접근 법

균등 격자의 한계는 다음과 같음

- 사업장 분포가 균등하지 않음
- 주어진 격자의 인접 격자를 찾기 까다로울 수 있음

##### 지오해시 (Geohash)

2차원의 위도 경도 데이터를 1차원의 문자열로 변환해 재귀적으로 더 작은 격자로 분할해 나가는 방식

**격자 가장자리 이슈**

- 가까운 두 위치가 공통 접두어가 없는 경우
  - 해당 케이스의 경우 `SELECT * FROM geohash_index WHERE geohash LIKE '9q8zn%'` 쿼리로는 사업장 조회 불가
- 공통 접두어 길이는 같지만 서로 다른 격자에 놓이는 경우

=> 일반적으로 현재 격자를 비롯한 인접한 모든 격자의 모든 사업장 정보를 가져오는 방식으로 문제 해결

##### 쿼드트리

> 격자의 내용이 특정 기준을 만족할 때 까지 2차원 공간을 재귀적으로 사분면 분할하는데 흔히 사용됨
>
> 쿼드트리의 경우 **메모리** 안에 놓이는 자료 구조일 뿐, DB가 아님



## 💡 3. 전부 읽고 난 후기

- 상세 세부 계획을 짜고 설계를 하는 방식을 엿볼 수 있어서 좋았음

## ❓ 4. 특별히 궁금했던 부분

- 내부 노드의 수는 왜 말단 노드 수의 1/ 3인가?